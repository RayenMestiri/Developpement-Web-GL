<div class="taches-container">
  <h1>ActivitÃ©s 5 & 6 : Gestion de TÃ¢ches ComplÃ¨te</h1>
  <p class="subtitle">Combinaison de *ngIf, *ngFor, [ngClass] et [ngStyle]</p>

  <!-- Statistiques -->
  <div class="stats-container">
    <div class="stat-card total">
      <span class="stat-number">{{ taches.length }}</span>
      <span class="stat-label">Total</span>
    </div>
    <div class="stat-card completes">
      <span class="stat-number">{{ getNombreTachesCompletes() }}</span>
      <span class="stat-label">ComplÃ©tÃ©es</span>
    </div>
    <div class="stat-card incompletes">
      <span class="stat-number">{{ getNombreTachesIncompletes() }}</span>
      <span class="stat-label">En cours</span>
    </div>
  </div>

  <!-- Formulaire d'ajout -->
  <div class="form-section">
    <h2>â• Ajouter une tÃ¢che</h2>
    
    <div class="form-row">
      <input 
        type="text" 
        [(ngModel)]="nouvelleDescription" 
        placeholder="Description de la tÃ¢che..."
        class="input-task"
        (keyup.enter)="ajouterTache()"
      />
      
      <select [(ngModel)]="nouvellePriorite" class="select-priority">
        <option value="haute">ğŸ”´ Haute</option>
        <option value="moyenne">ğŸŸ  Moyenne</option>
        <option value="basse">ğŸŸ¢ Basse</option>
      </select>
      
      <button (click)="ajouterTache()" class="btn-add">
        Ajouter
      </button>
    </div>
  </div>

  <!-- Filtres et actions -->
  <div class="filters-section">
    <div class="filters">
      <button 
        (click)="filtreStatut = 'toutes'" 
        [class.active]="filtreStatut === 'toutes'"
        class="btn-filter"
      >
        Toutes ({{ taches.length }})
      </button>
      <button 
        (click)="filtreStatut = 'incompletes'" 
        [class.active]="filtreStatut === 'incompletes'"
        class="btn-filter"
      >
        En cours ({{ getNombreTachesIncompletes() }})
      </button>
      <button 
        (click)="filtreStatut = 'completes'" 
        [class.active]="filtreStatut === 'completes'"
        class="btn-filter"
      >
        ComplÃ©tÃ©es ({{ getNombreTachesCompletes() }})
      </button>
    </div>

    <div class="actions-rapides">
      <button (click)="marquerToutesCompletes()" class="btn-action-mini">
        âœ“ Tout cocher
      </button>
      <button (click)="supprimerTachesCompletes()" class="btn-action-mini danger">
        ğŸ—‘ï¸ Supprimer complÃ©tÃ©es
      </button>
    </div>
  </div>

  <!-- 
    *ngIf avec else : Affichage conditionnel avancÃ© (ActivitÃ© 6)
    Si la liste est vide, affiche le template "pasDeTaches"
  -->
  <div *ngIf="getTachesFiltrees().length > 0; else pasDeTaches" class="taches-list">
    <!-- 
      *ngFor : ItÃ©ration sur les tÃ¢ches filtrÃ©es
      let i = index : rÃ©cupÃ¨re l'index de chaque Ã©lÃ©ment
    -->
    <div 
      *ngFor="let tache of getTachesFiltrees(); let i = index" 
      class="tache-item"
      [ngClass]="{'tache-completee': tache.statut}"
    >
      <!-- Checkbox pour marquer comme complÃ©tÃ©e -->
      <div class="tache-checkbox">
        <input 
          type="checkbox" 
          [checked]="tache.statut"
          (change)="toggleStatut(tache)"
          [id]="'tache-' + i"
        />
        <label [for]="'tache-' + i"></label>
      </div>

      <!-- Description de la tÃ¢che -->
      <!-- 
        [ngClass] : Applique la classe 'completed-text' si statut est true
        Permet de barrer le texte des tÃ¢ches complÃ©tÃ©es
      -->
      <div class="tache-content" [ngClass]="{'completed-text': tache.statut}">
        <span class="tache-description">{{ tache.description }}</span>
      </div>

      <!-- Badge de prioritÃ© -->
      <!-- 
        [ngStyle] : Applique des styles CSS dynamiques
        La couleur change selon la prioritÃ© :
        Rouge pour 'haute', Orange pour 'moyenne', Vert pour 'basse'
      -->
      <span 
        class="tache-priorite"
        [ngStyle]="{
          'color': getCouleurPriorite(tache.priorite),
          'border-color': getCouleurPriorite(tache.priorite),
          'font-weight': tache.priorite === 'haute' ? 'bold' : 'normal'
        }"
      >
        {{ tache.priorite }}
      </span>

      <!-- Boutons d'action -->
      <div class="tache-actions">
        <button 
          (click)="toggleStatut(tache)" 
          class="btn-toggle"
          [title]="tache.statut ? 'Marquer comme non complÃ©tÃ©e' : 'Marquer comme complÃ©tÃ©e'"
        >
          {{ tache.statut ? 'â†©ï¸' : 'âœ“' }}
        </button>
        <button 
          (click)="supprimerTache(i)" 
          class="btn-delete-small"
          title="Supprimer la tÃ¢che"
        >
          ğŸ—‘ï¸
        </button>
      </div>
    </div>
  </div>

  <!-- 
    ng-template : Template alternatif pour *ngIf...else (ActivitÃ© 6)
    Affiche un message personnalisÃ© quand il n'y a pas de tÃ¢ches
  -->
  <ng-template #pasDeTaches>
    <div class="empty-state">
      <div class="empty-icon">ğŸ“</div>
      <h3>Vous n'avez pas de tÃ¢ches en cours</h3>
      <p>Ajoutez votre premiÃ¨re tÃ¢che pour commencer!</p>
    </div>
  </ng-template>

  <!-- Section d'explication -->
  <div class="explanation">
    <h3>ğŸ“š Directives utilisÃ©es dans ce composant</h3>
    
    <div class="directive-explanation">
      <h4>1. *ngFor - ItÃ©ration sur les tÃ¢ches</h4>
      <pre><code>*ngFor="let tache of getTachesFiltrees(); let i = index"</code></pre>
      <p>CrÃ©e un Ã©lÃ©ment pour chaque tÃ¢che filtrÃ©e et fournit l'index.</p>
    </div>

    <div class="directive-explanation">
      <h4>2. *ngIf...else - Affichage conditionnel</h4>
      <pre><code>*ngIf="getTachesFiltrees().length > 0; else pasDeTaches"</code></pre>
      <p>Affiche la liste si elle contient des Ã©lÃ©ments, sinon affiche le template alternatif.</p>
    </div>

    <div class="directive-explanation">
      <h4>3. [ngClass] - Classes CSS conditionnelles</h4>
      <pre><code>[ngClass]="&#123;'tache-completee': tache.statut&#125;"</code></pre>
      <p>Applique la classe 'tache-completee' si la tÃ¢che est complÃ©tÃ©e (statut = true).</p>
    </div>

    <div class="directive-explanation">
      <h4>4. [ngStyle] - Styles CSS dynamiques</h4>
      <pre><code>[ngStyle]="&#123;'color': getCouleurPriorite(tache.priorite)&#125;"</code></pre>
      <p>Change la couleur du texte selon la prioritÃ© (rouge/orange/vert).</p>
    </div>
  </div>
</div>
